<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="fourjo.idle.goodgame.gg.repository.AdminReplyRepository">



    <delete id="AdminReplyDelete" parameterType="integer">
        delete from reply_mst where reply_index=#{relpy_index}
    </delete>

    <select id="AdminReplySearch"  parameterType="fourjo.idle.goodgame.gg.web.dto.AdminReplySearchDTO" resultType="fourjo.idle.goodgame.gg.web.dto.ReplyDto">
        select
        rm.reply_index as replyIndex,
        rm.board_index as boardIndex,
       rm.user_id as userId,
        rm.reply_content as replyContent,
        rm.reply_fir as replyFir,
        rm.reply_sec as replySec,
        rm.reply_reg_date as replyRegDate
        from reply_mst rm
       join user_mst um on (rm.user_id = um.user_index)
       <if test='searchKey == "cn" and  searchValue != null and searchValue !=""'>
            where (
            rm.reply_content like CONCAT('%',#{searchValue},'%') or
            um.user_nick like CONCAT('%', #{searchValue}, '%')
            )
        </if>
        <if test='searchKey == "c" '>
            where rm.reply_content like CONCAT('%',#{searchValue},'%')

        </if>
        <if test='searchKey == "n" '>
            where um.user_nick like CONCAT('%', #{searchValue}, '%')

        </if>
        order by
       reply_index desc
        <if test='limit == "Y"'>
            limit #{index}, #{count}
        </if>

    </select>
</mapper>